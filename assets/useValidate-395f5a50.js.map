{"version":3,"file":"useValidate-395f5a50.js","sources":["../../../src/utils/public/isAsync.ts","../../../src/hooks/private/useTypographyClassName.tsx","../../../src/hooks/private/useConvertChangeHandlerParam.tsx","../../../src/hooks/private/useFormatedValue.tsx","../../../src/hooks/private/useValidationMessageDynamicHeight.tsx","../../../src/contexts/ValidationContext.ts","../../../src/hooks/private/useValidationMessage.tsx","../../../src/hooks/public/useValidate.tsx"],"sourcesContent":["// eslint-disable-next-line func-names, @typescript-eslint/no-empty-function\nconst AsyncFunction = async function () {}.constructor;\n\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport const isAsync = (fn: Function) => fn instanceof AsyncFunction;\n","import { cleanClassName } from '@utils';\n\nimport styles from '../../styles/typography.module.scss';\n\ntype FontSize =\n  | 'large4x'\n  | 'large3x'\n  | 'large2x'\n  | 'large'\n  | 'medium'\n  | 'normal'\n  | 'small'\n  | 'small2x'\n  | 'small3x';\n\ntype FontWeight = 700 | 600 | 500 | 400;\n\nexport interface UseTypographyClassNameParams {\n  fontSize?: FontSize;\n  fontWeight?: FontWeight;\n}\n\nexport const useTypographyClassName = ({\n  fontSize,\n  fontWeight,\n}: UseTypographyClassNameParams) => ({\n  typographyClassName: cleanClassName(\n    `${styles[`font-size-${fontSize}`]} ${styles[`font-weight-${fontWeight}`]}`,\n  ),\n});\n","import { useMemo } from 'react';\n\nimport type { InputType } from './useFormatedValue';\n\nconst leftOnlyNumber = (value: string) => value.replace(/[^0-9]/g, '');\n\nexport const useConvertChangeHandlerParam = <T,>(type: InputType) =>\n  useMemo(() => {\n    switch (type) {\n      case 'number':\n      case 'large-number':\n        return (value) => (value ? Number(leftOnlyNumber(value)) : undefined);\n\n      case 'phone-number':\n        return (value) => {\n          let numberString = leftOnlyNumber(value);\n          if (numberString.length > 11) {\n            numberString = numberString.slice(0, 11);\n          }\n          return value ? numberString : undefined;\n        };\n\n      case 'business-number':\n        return (value) => {\n          let numberString = leftOnlyNumber(value);\n          if (numberString.length > 10) {\n            numberString = numberString.slice(0, 10);\n          }\n          return value ? numberString : undefined;\n        };\n\n      default:\n        return (value) => value || undefined;\n    }\n  }, [type]) as (value: string) => T;\n","import { useState } from 'react';\n\nexport type InputType =\n  | 'text'\n  | 'number'\n  | 'large-number'\n  | 'phone-number'\n  | 'business-number'\n  | 'password'\n  | 'button';\n\ninterface UseFormatedValueParams<T> {\n  value: T;\n  placeholder: string;\n  type: InputType;\n}\n\nexport const useFormatedValue = <T,>({\n  type,\n  value,\n  placeholder,\n}: UseFormatedValueParams<T>) => {\n  const [isDisplayFormatedValue, setIsDisplayFormatedValue] = useState(true);\n\n  return {\n    formatedValue: (() => {\n      if (!value) {\n        if (type === 'button') {\n          return placeholder;\n        }\n        if (value !== 0) {\n          return '';\n        }\n      }\n\n      const valueString = String(value);\n\n      if (!isDisplayFormatedValue) {\n        return valueString;\n      }\n\n      switch (type) {\n        case 'number':\n          return valueString;\n\n        case 'large-number':\n          return Number(valueString).toLocaleString();\n\n        case 'phone-number':\n          if (valueString.length === 10) {\n            return valueString.replace(/(\\d{3})(\\d{3})(\\d{4})/, '$1-$2-$3');\n          }\n          return valueString.replace(/(\\d{3})(\\d{4})(\\d{4})/, '$1-$2-$3');\n\n        case 'business-number':\n          return valueString.replace(/(\\d{3})(\\d{2})(\\d{5})/, '$1-$2-$3');\n\n        default:\n          return valueString;\n      }\n    })(),\n\n    setIsDisplayFormatedValue,\n  };\n};\n","import { useEffect, useRef, useState } from 'react';\n\nexport const useValidationMessageDynamicHeight = (\n  isMessageVisible: boolean,\n) => {\n  const messageRef = useRef<HTMLParagraphElement>(null);\n  const height = messageRef.current?.offsetHeight;\n\n  const [wrapHeightStyle, setWrapHeightStyle] =\n    useState<Pick<React.CSSProperties, 'height'>>();\n  useEffect(() => {\n    if (isMessageVisible) {\n      setWrapHeightStyle({\n        height,\n      });\n    } else {\n      setWrapHeightStyle(undefined);\n    }\n  }, [height, isMessageVisible]);\n\n  return {\n    messageRef,\n    wrapHeightStyle,\n  };\n};\n","import { createContext } from 'react';\n\nexport type ValidationResult = string | undefined;\n\nexport type ValidationContextValue = Map<\n  string,\n  () => ValidationResult | Promise<ValidationResult>\n>;\n\n/**\n * @deprecated Use `ValidationContextValue` instead.\n */\nexport type ValidationStoreData = ValidationContextValue;\n\nexport const ValidationContext = createContext<ValidationContextValue | null>(\n  null,\n);\n","import { useState, useContext, useEffect } from 'react';\n\nimport { ValidationContext } from '@contexts/ValidationContext';\nimport type { ValidationResult } from '@contexts/ValidationContext';\nimport { isAsync } from '@utils';\n\nexport type ValidateHandler<TValue> =\n  | ((value: TValue) => ValidationResult | Promise<ValidationResult>)\n  | undefined;\n\nexport type ValidationTrigger = 'onChange' | 'onBlur';\n\ninterface UseValidationMessageParams<TValue> {\n  validationTrigger?: ValidationTrigger;\n  key?: string;\n  value: TValue;\n  validateHandler: ValidateHandler<TValue>;\n}\n\nexport const useValidationMessage = <TValue,>({\n  key,\n  value,\n  validateHandler,\n  validationTrigger = 'onBlur',\n}: UseValidationMessageParams<TValue>) => {\n  const validationContext = useContext(ValidationContext);\n\n  const [validationMessage, setValidationMessage] = useState<string>();\n\n  useEffect(() => {\n    if (validationContext && key && validateHandler) {\n      validationContext.set(\n        key,\n        isAsync(validateHandler)\n          ? async () => {\n              const validationMessage = await validateHandler(value);\n              setValidationMessage(validationMessage);\n              return validationMessage;\n            }\n          : () => {\n              const validationMessage = validateHandler(\n                value,\n              ) as ValidationResult;\n              setValidationMessage(validationMessage);\n              return validationMessage;\n            },\n      );\n\n      return () => {\n        validationContext.delete(key);\n      };\n    }\n  }, [key, validateHandler, validationContext, value]);\n\n  const validateOnTrigger = {\n    onChange: {\n      validateOnChange: async (value: TValue) =>\n        setValidationMessage(await validateHandler?.(value)),\n    },\n    onBlur: {\n      validateOnBlur: async () =>\n        setValidationMessage(await validateHandler?.(value)),\n    },\n  }[validationTrigger];\n\n  return {\n    ...validateOnTrigger,\n    validationMessage,\n  };\n};\n","import { useContext, useRef } from 'react';\n\nimport { ValidationContext } from '@contexts/ValidationContext';\nimport type { ValidationContextValue } from '@contexts/ValidationContext';\n\ninterface ValidateOptions {\n  scrollToFirstInvalid?: boolean;\n}\n\nexport const useValidate = () => {\n  const validationContext = useContext(ValidationContext);\n\n  const { current } = useRef(\n    (() => {\n      const scrollToFirstInvalid = (\n        invalidElementIds: string[],\n        options?: ValidateOptions,\n      ) => {\n        const scrollToFirstInvalid = options?.scrollToFirstInvalid ?? true;\n\n        if (scrollToFirstInvalid && !invalidElementIds.length) {\n          const [firstInvalidElementId] = invalidElementIds;\n\n          const firstInvalidElement = document.getElementById(\n            firstInvalidElementId,\n          );\n\n          firstInvalidElement?.scrollIntoView({\n            behavior: 'smooth',\n            block: 'center',\n          });\n        }\n      };\n\n      return {\n        validationContext,\n\n        validate: (options?: ValidateOptions) => {\n          const invalidElementIds: string[] = [];\n\n          validationContext?.forEach((validateOnChange, id) => {\n            if (validateOnChange()) {\n              invalidElementIds.push(id);\n            }\n          });\n\n          scrollToFirstInvalid(invalidElementIds, options);\n\n          return {\n            isValid: !invalidElementIds.length,\n            invalidElementIds,\n          };\n        },\n\n        validateAsync: async (options?: ValidateOptions) => {\n          const idList: string[] = [];\n\n          const validationMessageList = await Promise.all(\n            Array.from(validationContext?.entries() || []).map(\n              ([id, validateOnChange]) => {\n                idList.push(id);\n                return validateOnChange();\n              },\n            ),\n          );\n\n          const invalidElementIds = idList.filter(\n            (_, index) => validationMessageList[index],\n          );\n\n          scrollToFirstInvalid(invalidElementIds, options);\n\n          return {\n            isValid: validationMessageList.every((message) => !message),\n            invalidElementIds,\n          };\n        },\n      };\n    })(),\n  );\n\n  return current;\n};\n\nexport const validationObserver = <T extends object>(\n  Component: (props: T) => JSX.Element | null,\n) => {\n  const validationStore: ValidationContextValue = new Map();\n  // eslint-disable-next-line react/function-component-definition\n  return (props: T) => (\n    <ValidationContext.Provider value={validationStore}>\n      <Component {...props} />\n    </ValidationContext.Provider>\n  );\n};\n"],"names":["AsyncFunction","isAsync","fn","useTypographyClassName","fontSize","fontWeight","cleanClassName","styles","leftOnlyNumber","value","useConvertChangeHandlerParam","type","useMemo","numberString","useFormatedValue","placeholder","isDisplayFormatedValue","setIsDisplayFormatedValue","useState","valueString","useValidationMessageDynamicHeight","isMessageVisible","messageRef","useRef","height","_a","wrapHeightStyle","setWrapHeightStyle","useEffect","ValidationContext","createContext","useValidationMessage","key","validateHandler","validationTrigger","validationContext","useContext","validationMessage","setValidationMessage","validationMessage2","value2","validationObserver","Component","validationStore","props","jsx"],"mappings":"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"}