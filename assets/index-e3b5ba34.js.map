{"version":3,"file":"index-e3b5ba34.js","sources":["../../../src/plugins/Compatibility.tsx"],"sourcesContent":["import type { LinkProps as NextLinkProps } from 'next/link';\nimport type NextLink from 'next/link';\nimport type { useRouter as useNextRouter } from 'next/router';\nimport { useLayoutEffect, useEffect } from 'react';\nimport type {\n  Link as ReactLink,\n  LinkProps as ReactLinkProps,\n  useLocation as useReactLocation,\n} from 'react-router-dom';\n\nexport type CompatibleLinkProps = (NextLinkProps | ReactLinkProps) & {\n  to: ReactLinkProps['to'];\n  children: ReactLinkProps['children'];\n  className?: ReactLinkProps['className'];\n};\n\ntype NextLinkComponent = typeof NextLink;\ntype ReactLinkComponent = typeof ReactLink;\ntype UseNextRouter = typeof useNextRouter;\ntype UseReactLocation = typeof useReactLocation;\ntype Libraries = 'next' | 'react';\ninterface Dependencies<_Type extends Libraries> {\n  location: _Type extends 'next' ? UseNextRouter : UseReactLocation;\n  link: _Type extends 'next' ? NextLinkComponent : ReactLinkComponent;\n}\n\ntype CompatibleLocationReturnType = (\n  | ReturnType<UseNextRouter>\n  | ReturnType<UseReactLocation>\n) & {\n  search: string;\n};\n\nexport class Compatibility {\n  public static Link: (props: CompatibleLinkProps) => JSX.Element;\n\n  public static useLocation: () => CompatibleLocationReturnType;\n\n  public static useLayoutEffect = useLayoutEffect;\n\n  public static injectDependencies = <_Type extends Libraries>(\n    type: _Type,\n    { location, link }: Dependencies<_Type>,\n  ) => {\n    switch (type) {\n      case 'next': {\n        const NextLink = link as NextLinkComponent;\n        const getRouter = location as UseNextRouter;\n        this.Link = function Link({ to, ...restProps }: CompatibleLinkProps) {\n          return <NextLink {...restProps} href={to} />;\n        };\n        this.useLocation = () => {\n          const router = getRouter();\n          const { asPath, query } = router;\n          const [pathname, search] = asPath.split('?');\n          return {\n            ...router,\n            pathname,\n            search: search && Object.keys(query).length ? `?${search}` : '',\n          };\n        };\n        this.useLayoutEffect = useEffect;\n        break;\n      }\n      case 'react': {\n        const ReactLink = link as ReactLinkComponent;\n        const useLocation = location as UseReactLocation;\n        this.Link = function Link(props: CompatibleLinkProps) {\n          return <ReactLink {...props} />;\n        };\n        this.useLocation = useLocation;\n        break;\n      }\n\n      default:\n        break;\n    }\n  };\n}\n"],"names":["Compatibility$1","_a","__publicField","useLayoutEffect","type","location","link","NextLink","getRouter","to","restProps","jsx","router","asPath","query","pathname","search","useEffect","ReactLink","useLocation","props"],"mappings":"oQAiCO,IAAAA,GAAAC,EAAA,KAAA,CA6CP,EA7C2BC,EAApBD,EAAoB,QACXC,EADTD,EACS,eAEAC,EAHTD,EAGS,kBAAAE,EAAAA,iBAEkBD,EAL3BD,EAK2B,qBAAA,CAAAG,EAAA,CAAA,SAAAC,EAAA,KAAAC,CAAA,IAAA,CAM9B,OAAAF,EAAA,CAAc,IAAA,OAAA,CAEV,MAAAG,EAAAD,EACAE,EAAAH,EACAJ,EAAA,KAAA,SAAA,CAAA,GAAAQ,EAAA,GAAAC,GAAA,CACE,OAAAC,EAAAA,IAAAJ,EAAA,CAAA,GAAAG,EAAA,KAAAD,CAAA,CAAA,CAA0C,EAE5CR,EAAA,YAAA,IAAA,CACE,MAAAW,EAAAJ,IACA,CAAA,OAAAK,EAAA,MAAAC,CAAA,EAAAF,EACA,CAAAG,EAAAC,CAAA,EAAAH,EAAA,MAAA,GAAA,EACA,MAAA,CAAO,GAAAD,EACF,SAAAG,EACH,OAAAC,GAAA,OAAA,KAAAF,CAAA,EAAA,OAAA,IAAAE,IAAA,EAC6D,CAC/D,EAEFf,EAAA,gBAAAgB,YACA,KAAA,CACF,IAAA,QAAA,CAEE,MAAAC,EAAAZ,EACAa,EAAAd,EACAJ,EAAA,KAAA,SAAAmB,EAAA,CACE,OAAAT,EAAA,IAAAO,EAAA,CAAA,GAAAE,CAAA,CAAA,CAA6B,EAE/BnB,EAAA,YAAAkB,EACA,KAAA,CAIA,CACJ,GA3CGlB"}